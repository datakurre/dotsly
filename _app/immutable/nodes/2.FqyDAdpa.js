import"../chunks/DsnmJJEf.js";import"../chunks/DiWgoKHH.js";import{A as Ae,o as Le,y as re,q as H,ay as He,v as Ue,g as i,Q as Be,w as Oe,H as Pe,x as be,z as ae,I as J,ad as Ge,aG as Fe,B as fe,D as Ve,C as Ye,ac as ze,a4 as X,aa as we,aD as Ee,av as Xe,aR as je,F as Te,G as Ke,aS as Qe,aT as We,aU as ne,al as xe,ar as Ze,aV as $e,aC as Je,aW as et,N as tt,aX as rt,aY as at,aZ as nt,a_ as it,i as K,t as W,k as B,m as q,n as N,p as ue,a$ as st,b0 as lt,_ as ie,j as se,b as Q,l as ve,b1 as le,M as F,e as oe,s as Y,b2 as ot}from"../chunks/CezrgYUq.js";import{e as j,c as ct,a as ft}from"../chunks/DfvYGNSv.js";import{p as G,i as ee}from"../chunks/CTiD2ntr.js";import{i as he}from"../chunks/m5EpKNiI.js";function Ce(r,t){return t}function dt(r,t,e){for(var a=r.items,l=[],o=t.length,c=0;c<o;c++)$e(t[c].e,l,!0);var p=o>0&&l.length===0&&e!==null;if(p){var w=e.parentNode;Je(w),w.append(e),a.clear(),P(r,t[0].prev,t[o-1].next)}et(l,()=>{for(var d=0;d<o;d++){var E=t[d];p||(a.delete(E.k),P(r,E.prev,E.next)),xe(E.e,!p)}})}function Ie(r,t,e,a,l,o=null){var c=r,p={flags:t,items:new Map,first:null};{var w=r;c=H?re(He(w)):w.appendChild(Ae())}H&&Ue();var d=null,E=!1,x=new Map,v=Be(()=>{var u=e();return Xe(u)?u:u==null?[]:Ee(u)}),h,n;function g(){ut(n,h,p,x,c,l,t,a,e),o!==null&&(h.length===0?d?Te(d):d=fe(()=>o(c)):d!==null&&Ke(d,()=>{d=null}))}Le(()=>{n??=tt,h=i(v);var u=h.length;if(E&&u===0)return;E=u===0;let A=!1;if(H){var f=Oe(c)===Pe;f!==(u===0)&&(c=be(),re(c),ae(!1),A=!0)}if(H){for(var s=null,_,m=0;m<u;m++){if(J.nodeType===Ge&&J.data===Fe){c=J,A=!0,ae(!1);break}var b=h[m],S=a(b,m);_=de(J,p,s,null,b,S,m,l,t,e),p.items.set(S,_),s=_}u>0&&re(be())}if(H)u===0&&o&&(d=fe(()=>o(c)));else if(Ve()){var y=new Set,M=Ye;for(m=0;m<u;m+=1){b=h[m],S=a(b,m);var T=p.items.get(S)??x.get(S);T?Ne(T,b,m):(_=de(null,p,null,null,b,S,m,l,t,e,!0),x.set(S,_)),y.add(S)}for(const[k,R]of p.items)y.has(k)||M.skipped_effects.add(R.e);M.add_callback(g)}else g();A&&ae(!0),i(v)}),H&&(c=J)}function ut(r,t,e,a,l,o,c,p,w){var d=t.length,E=e.items,x=e.first,v=x,h,n=null,g=[],u=[],A,f,s,_;for(_=0;_<d;_+=1){if(A=t[_],f=p(A,_),s=E.get(f),s===void 0){var m=a.get(f);if(m!==void 0){a.delete(f),E.set(f,m);var b=n?n.next:v;P(e,n,m),P(e,m,b),ce(m,b,l),n=m}else{var S=v?v.e.nodes_start:l;n=de(S,e,n,n===null?e.first:n.next,A,f,_,o,c,w)}E.set(f,n),g=[],u=[],v=n.next;continue}if(Ne(s,A,_),(s.e.f&ne)!==0&&Te(s.e),s!==v){if(h!==void 0&&h.has(s)){if(g.length<u.length){var y=u[0],M;n=y.prev;var T=g[0],k=g[g.length-1];for(M=0;M<g.length;M+=1)ce(g[M],y,l);for(M=0;M<u.length;M+=1)h.delete(u[M]);P(e,T.prev,k.next),P(e,n,T),P(e,k,y),v=y,n=k,_-=1,g=[],u=[]}else h.delete(s),ce(s,v,l),P(e,s.prev,s.next),P(e,s,n===null?e.first:n.next),P(e,n,s),n=s;continue}for(g=[],u=[];v!==null&&v.k!==f;)(v.e.f&ne)===0&&(h??=new Set).add(v),u.push(v),v=v.next;if(v===null)continue;s=v}g.push(s),n=s,v=s.next}if(v!==null||h!==void 0){for(var R=h===void 0?[]:Ee(h);v!==null;)(v.e.f&ne)===0&&R.push(v),v=v.next;var I=R.length;if(I>0){var U=d===0?l:null;dt(e,R,U)}}r.first=e.first&&e.first.e,r.last=n&&n.e;for(var V of a.values())xe(V.e);a.clear()}function Ne(r,t,e,a){ze(r.v,t),r.i=e}function de(r,t,e,a,l,o,c,p,w,d,E){var x=(w&Qe)!==0,v=(w&We)===0,h=x?v?X(l,!1,!1):we(l):l,n=(w&je)===0?c:we(c),g={i:n,v:h,k:o,a:null,e:null,prev:e,next:a};try{if(r===null){var u=document.createDocumentFragment();u.append(r=Ae())}return g.e=fe(()=>p(r,h,n,d),H),g.e.prev=e&&e.e,g.e.next=a&&a.e,e===null?E||(t.first=g):(e.next=g,e.e.next=g.e),a!==null&&(a.prev=g,a.e.prev=g.e),g}finally{}}function ce(r,t,e){for(var a=r.next?r.next.e.nodes_start:e,l=t?t.e.nodes_start:e,o=r.e.nodes_start;o!==null&&o!==a;){var c=Ze(o);l.before(o),o=c}}function P(r,t,e){t===null?r.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}const ye=[...` 	
\r\fÂ \v\uFEFF`];function vt(r,t,e){var a=""+r;if(e){for(var l in e)if(e[l])a=a?a+" "+l:l;else if(a.length)for(var o=l.length,c=0;(c=a.indexOf(l,c))>=0;){var p=c+o;(c===0||ye.includes(a[c-1]))&&(p===a.length||ye.includes(a[p]))?a=(c===0?"":a.substring(0,c))+a.substring(p+1):c=p}}return a===""?null:a}function ht(r,t){return r==null?null:String(r)}function te(r,t,e,a,l,o){var c=r.__className;if(H||c!==e||c===void 0){var p=vt(e,a,o);(!H||p!==r.getAttribute("class"))&&(p==null?r.removeAttribute("class"):r.className=p),r.__className=e}else if(o&&l!==o)for(var w in o){var d=!!o[w];(l==null||d!==!!l[w])&&r.classList.toggle(w,d)}return o}function Z(r,t,e,a){var l=r.__style;if(H||l!==t){var o=ht(t);(!H||o!==r.getAttribute("style"))&&(o==null?r.removeAttribute("style"):r.style.cssText=o),r.__style=t}return a}const gt=Symbol("is custom element"),pt=Symbol("is html");function z(r,t,e,a){var l=_t(r);H&&(l[t]=r.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&r.nodeName==="LINK")||l[t]!==(l[t]=e)&&(t==="loading"&&(r[rt]=e),e==null?r.removeAttribute(t):typeof e!="string"&&mt(r).includes(t)?r[t]=e:r.setAttribute(t,e))}function _t(r){return r.__attributes??={[gt]:r.nodeName.includes("-"),[pt]:r.namespaceURI===at}}var Me=new Map;function mt(r){var t=r.getAttribute("is")||r.nodeName,e=Me.get(t);if(e)return e;Me.set(t,e=[]);for(var a,l=r,o=Element.prototype;o!==l;){a=it(l);for(var c in a)a[c].set&&e.push(c);l=nt(l)}return e}var bt=K('<div class="square svelte-gxsx5p"></div>');function ke(r,t){let e=G(t,"color",8,"#000");var a=bt();W(()=>Z(a,`--color: ${e()??""}`)),B(r,a)}var wt=K('<div class="circle svelte-r5z0cw"></div>');function De(r,t){let e=G(t,"color",8,"#000");var a=wt();W(()=>Z(a,`--color: ${e()??""}`)),B(r,a)}var yt=K('<div class="arch-container svelte-1isloo0"><svg width="100%" height="100%" viewBox="0 0 100 100" preserveAspectRatio="none"><circle cx="0" cy="0" r="100"></circle></svg></div>');function qe(r,t){let e=G(t,"color",8,"#000"),a=G(t,"rotation",8,0);var l=yt(),o=q(l),c=q(o);N(o),N(l),W(()=>{Z(l,`transform: rotate(${a()*90}deg);`),z(c,"fill",e())}),B(r,l)}var Mt=K('<div class="cell svelte-1w4104m" role="button" tabindex="0"><!></div>'),St=K('<div class="container svelte-1w4104m"><div class="grid svelte-1w4104m"></div></div>');function Se(r,t){ue(t,!1);let e=G(t,"paintMode",8,!1);function a(h){const n=i(d)[h];if(!n)return E(h);const{shape:g,color:u}=n;if(g===p()&&u===w())return;const A=[h],f=new Set;for(;A.length;){const s=A.pop();if(s===void 0||f.has(s))continue;f.add(s);const _=i(d)[s];if(!_||_.shape!==g||_.color!==u)continue;le(d,i(d)[s]={shape:p(),color:w(),rotation:0});const m=s%o(),b=Math.floor(s/o());m>0&&A.push(s-1),m<o()-1&&A.push(s+1),b>0&&A.push(s-o()),b<c()-1&&A.push(s+o())}F(d,[...i(d)])}let l=G(t,"grid",8,null),o=G(t,"width",8,32),c=G(t,"height",8,32),p=G(t,"selectedShape",8,"square"),w=G(t,"selectedColor",8,"#000000"),d=X();function E(h){const n=i(d)[h];n&&n.shape==="arch"&&n.color===w()?le(d,i(d)[h]={...n,rotation:(n.rotation+1)%4}):le(d,i(d)[h]={shape:p(),color:w(),rotation:0}),F(d,[...i(d)])}st(()=>(oe(l()),oe(o()),oe(c())),()=>{F(d,l()||Array(o()*c()).fill(null))}),lt(),he();var x=St(),v=q(x);Ie(v,5,()=>i(d),Ce,(h,n,g)=>{var u=Mt(),A=q(u);{var f=s=>{var _=ie(),m=se(_);{var b=y=>{ke(y,{get color(){return i(n),Q(()=>i(n).color)}})},S=y=>{var M=ie(),T=se(M);{var k=I=>{De(I,{get color(){return i(n),Q(()=>i(n).color)}})},R=I=>{var U=ie(),V=se(U);{var C=D=>{qe(D,{get color(){return i(n),Q(()=>i(n).color)},get rotation(){return i(n),Q(()=>i(n).rotation)}})};ee(V,D=>{i(n),Q(()=>i(n).shape==="arch")&&D(C)},!0)}B(I,U)};ee(T,I=>{i(n),Q(()=>i(n).shape==="circle")?I(k):I(R,!1)},!0)}B(y,M)};ee(m,y=>{i(n),Q(()=>i(n).shape==="square")?y(b):y(S,!1)})}B(s,_)};ee(A,s=>{i(n)&&s(f)})}N(u),j("click",u,()=>e()?a(g):E(g)),j("keydown",u,s=>(e()?a(g):E(g))&&s.key==="Enter"),B(h,u)}),N(v),N(x),W(()=>Z(v,`--width: ${o()??""}; --height: ${c()??""};`)),B(r,x),ve()}var At=K('<button type="button"></button>'),Et=K('<div class="toolbar svelte-1ld6r3r"><div class="shapes svelte-1ld6r3r" style="display: flex; align-items: center;"><button aria-label="Square" style="width: 2.5rem; height: 2.5rem; padding: 0; display: inline-flex; align-items: center; justify-content: center;"><!></button> <button aria-label="Circle" style="width: 2.5rem; height: 2.5rem; padding: 0; display: inline-flex; align-items: center; justify-content: center;"><!></button> <button aria-label="Arch" style="width: 2.5rem; height: 2.5rem; padding: 0; display: inline-flex; align-items: center; justify-content: center;"><!></button> <button type="button" aria-label="Paint roller tool"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="6" y="4" width="10" height="4" rx="1.5"></rect><path d="M16 6v4c0 1-1 2-2 2H10c-1 0-2-1-2-2V6"></path><rect x="11" y="14" width="2" height="5" rx="1"></rect><path d="M12 12v2"></path></svg></button></div> <div class="colors" style="display: flex; gap: 0.25rem; align-items: center;"></div> <div class="image-upload"><input type="file" accept="image/png, image/jpeg"/></div></div>');function Tt(r,t){ue(t,!1);let e=X(!1);function a(){F(e,!i(e)),c("paintModeToggled",{paintMode:i(e)})}const l=["#ffffff","#000000","#f4d23e","#e4a9a8","#e3000b","#ff9c08","#008f9b","#0055bf","#a5ca18","#237841","#b4004e","#f785b1","#fbe870","#f5cd2f","#c870a0","#e4e7e7"];function o(C){F(w,C),c("colorSelected",{color:C})}const c=ct();let p=X("square"),w=X("#000000");function d(C){F(p,C),c("shapeSelected",{shape:C})}function E(C){const D=C.target,L=D.files&&D.files[0];if(L){const O=new FileReader;O.onload=()=>{c("imageUploaded",{src:O.result})},O.readAsDataURL(L)}}he();var x=Et(),v=q(x),h=q(v);let n;var g=q(h);ke(g,{get color(){return i(w)}}),N(h);var u=Y(h,2);let A;var f=q(u);De(f,{get color(){return i(w)}}),N(u);var s=Y(u,2);let _;var m=q(s);qe(m,{get color(){return i(w)},rotation:0}),N(s);var b=Y(s,2);let S;var y=q(b),M=q(y),T=Y(M),k=Y(T),R=Y(k);N(y),N(b),N(v);var I=Y(v,2);Ie(I,5,()=>l,Ce,(C,D)=>{var L=At();W(()=>{Z(L,`width: 1.5rem; height: 1.5rem; background: ${i(D)??""}; border: 2px solid ${i(w)===i(D)?"#333":"#ccc"}; border-radius: 0.25rem; cursor: pointer;`),z(L,"aria-label",i(D))}),j("click",L,()=>o(i(D))),B(C,L)}),N(I);var U=Y(I,2),V=q(U);N(U),N(x),W((C,D,L,O)=>{n=te(h,1,"svelte-1ld6r3r",null,n,C),A=te(u,1,"svelte-1ld6r3r",null,A,D),_=te(s,1,"svelte-1ld6r3r",null,_,L),Z(b,`width: 2.5rem; height: 2.5rem; margin-left: 0.5rem; display: inline-flex; align-items: center; justify-content: center; border: 2px solid ${i(e)?"#333":"#ccc"}; background: ${i(e)?"#f4d23e":"#fff"}; border-radius: 0.5rem; cursor: pointer;`),S=te(b,1,"svelte-1ld6r3r",null,S,O),z(y,"stroke",i(e)?"#333":"#888"),z(M,"fill",i(e)?"#f4d23e":"#fff"),z(M,"stroke",i(e)?"#333":"#888"),z(T,"stroke",i(e)?"#333":"#888"),z(k,"fill",i(e)?"#f4d23e":"#fff"),z(k,"stroke",i(e)?"#333":"#888"),z(R,"stroke",i(e)?"#333":"#888")},[()=>({selected:i(p)==="square"}),()=>({selected:i(p)==="circle"}),()=>({selected:i(p)==="arch"}),()=>({active:i(e)})]),j("click",h,()=>d("square")),j("click",u,()=>d("circle")),j("click",s,()=>d("arch")),j("click",b,a),j("change",V,E),B(r,x),ve()}var xt=K('<main class="svelte-1uha8ag"><!> <!></main>');function Rt(r,t){ue(t,!1);let e=X("square"),a=X("#000000"),l=X(null),o=X(!1);function c(f){F(e,f.detail.shape)}function p(f){F(a,f.detail.color)}function w(f){const s=new Image;s.src=f.detail.src,s.onload=()=>{const _=document.createElement("canvas"),m=_.getContext("2d"),b=32,S=32;_.width=b,_.height=S,m.drawImage(s,0,0,b,S);const y=m.getImageData(0,0,b,S).data,M=[];for(let T=0;T<y.length;T+=4){const k=T/4,R=k%b,I=Math.floor(k/b);let U=y[T],V=y[T+1],C=y[T+2];y[T+3]===0&&(U=255,V=255,C=255);const L=(U+V+C)/3;let O=v(L),$=0;const ge=I===0,pe=I===S-1,_e=R===0,me=R===b-1;O==="arch"&&(ge||pe||_e||me)?ge?$=2:pe?$=0:_e?$=1:me&&($=3):O==="arch"&&(O=L<128?"square":"circle");const Re=x(U,V,C);M.push({shape:O,color:Re,rotation:$})}F(l,M)}}const d=["#ffffff","#000000","#f4d23e","#e4a9a8","#e3000b","#ff9c08","#008f9b","#0055bf","#a5ca18","#237841","#b4004e","#f785b1","#fbe870","#f5cd2f","#c870a0","#e4e7e7"];function E(f){f=f.replace(/^#/,""),f.length===3&&(f=f.split("").map(_=>_+_).join(""));const s=parseInt(f,16);return{r:s>>16&255,g:s>>8&255,b:s&255}}function x(f,s,_){let m=d[0],b=1/0;for(const S of d){const y=E(S),M=Math.sqrt(Math.pow(f-y.r,2)+Math.pow(s-y.g,2)+Math.pow(_-y.b,2));M<b&&(b=M,m=S)}return m}function v(f){return f<85?"square":f<170?"arch":"circle"}he();var h=xt();ft(f=>{ot.title="Dotsly"});var n=q(h);Tt(n,{$$events:{shapeSelected:c,colorSelected:p,imageUploaded:w,paintModeToggled:f=>F(o,f.detail.paintMode)}});var g=Y(n,2);{var u=f=>{Se(f,{width:32,height:32,get selectedShape(){return i(e)},get selectedColor(){return i(a)},get grid(){return i(l)},get paintMode(){return i(o)}})},A=f=>{Se(f,{width:32,height:32,get selectedShape(){return i(e)},get selectedColor(){return i(a)},get paintMode(){return i(o)}})};ee(g,f=>{i(l)?f(u):f(A,!1)})}N(h),B(r,h),ve()}export{Rt as component};
