import"../chunks/DsnmJJEf.js";import"../chunks/DiWgoKHH.js";import{A as Se,o as Re,y as te,q as H,ay as Le,v as He,g as i,Q as Ue,w as Be,H as Oe,x as me,z as re,I as $,ad as Pe,aG as Ge,B as ce,D as Fe,C as Ve,ac as Ye,a4 as z,aa as be,aD as Ae,av as ze,aR as Xe,F as Ee,G as je,aS as Ke,aT as Qe,aU as ae,al as Te,ar as We,aV as Ze,aC as $e,aW as Je,N as et,aX as tt,aY as rt,aZ as at,a_ as nt,i as K,t as W,k as B,m as R,n as k,p as de,a$ as it,b0 as st,_ as ne,j as ie,b as Q,l as ue,b1 as se,M as F,e as le,s as V,b2 as lt}from"../chunks/CezrgYUq.js";import{e as j,c as ot,a as ct}from"../chunks/DfvYGNSv.js";import{p as G,i as J}from"../chunks/CTiD2ntr.js";import{i as ve}from"../chunks/m5EpKNiI.js";function xe(r,t){return t}function ft(r,t,e){for(var a=r.items,l=[],o=t.length,c=0;c<o;c++)Ze(t[c].e,l,!0);var p=o>0&&l.length===0&&e!==null;if(p){var w=e.parentNode;$e(w),w.append(e),a.clear(),P(r,t[0].prev,t[o-1].next)}Je(l,()=>{for(var d=0;d<o;d++){var E=t[d];p||(a.delete(E.k),P(r,E.prev,E.next)),Te(E.e,!p)}})}function Ce(r,t,e,a,l,o=null){var c=r,p={flags:t,items:new Map,first:null};{var w=r;c=H?te(Le(w)):w.appendChild(Se())}H&&He();var d=null,E=!1,T=new Map,v=Ue(()=>{var u=e();return ze(u)?u:u==null?[]:Ae(u)}),h,n;function g(){dt(n,h,p,T,c,l,t,a,e),o!==null&&(h.length===0?d?Ee(d):d=ce(()=>o(c)):d!==null&&je(d,()=>{d=null}))}Re(()=>{n??=et,h=i(v);var u=h.length;if(E&&u===0)return;E=u===0;let A=!1;if(H){var f=Be(c)===Oe;f!==(u===0)&&(c=me(),te(c),re(!1),A=!0)}if(H){for(var s=null,_,m=0;m<u;m++){if($.nodeType===Pe&&$.data===Ge){c=$,A=!0,re(!1);break}var b=h[m],S=a(b,m);_=fe($,p,s,null,b,S,m,l,t,e),p.items.set(S,_),s=_}u>0&&te(me())}if(H)u===0&&o&&(d=ce(()=>o(c)));else if(Fe()){var y=new Set,M=Ve;for(m=0;m<u;m+=1){b=h[m],S=a(b,m);var x=p.items.get(S)??T.get(S);x?Ie(x,b,m):(_=fe(null,p,null,null,b,S,m,l,t,e,!0),T.set(S,_)),y.add(S)}for(const[D,L]of p.items)y.has(D)||M.skipped_effects.add(L.e);M.add_callback(g)}else g();A&&re(!0),i(v)}),H&&(c=$)}function dt(r,t,e,a,l,o,c,p,w){var d=t.length,E=e.items,T=e.first,v=T,h,n=null,g=[],u=[],A,f,s,_;for(_=0;_<d;_+=1){if(A=t[_],f=p(A,_),s=E.get(f),s===void 0){var m=a.get(f);if(m!==void 0){a.delete(f),E.set(f,m);var b=n?n.next:v;P(e,n,m),P(e,m,b),oe(m,b,l),n=m}else{var S=v?v.e.nodes_start:l;n=fe(S,e,n,n===null?e.first:n.next,A,f,_,o,c,w)}E.set(f,n),g=[],u=[],v=n.next;continue}if(Ie(s,A,_),(s.e.f&ae)!==0&&Ee(s.e),s!==v){if(h!==void 0&&h.has(s)){if(g.length<u.length){var y=u[0],M;n=y.prev;var x=g[0],D=g[g.length-1];for(M=0;M<g.length;M+=1)oe(g[M],y,l);for(M=0;M<u.length;M+=1)h.delete(u[M]);P(e,x.prev,D.next),P(e,n,x),P(e,D,y),v=y,n=D,_-=1,g=[],u=[]}else h.delete(s),oe(s,v,l),P(e,s.prev,s.next),P(e,s,n===null?e.first:n.next),P(e,n,s),n=s;continue}for(g=[],u=[];v!==null&&v.k!==f;)(v.e.f&ae)===0&&(h??=new Set).add(v),u.push(v),v=v.next;if(v===null)continue;s=v}g.push(s),n=s,v=s.next}if(v!==null||h!==void 0){for(var L=h===void 0?[]:Ae(h);v!==null;)(v.e.f&ae)===0&&L.push(v),v=v.next;var N=L.length;if(N>0){var O=d===0?l:null;ft(e,L,O)}}r.first=e.first&&e.first.e,r.last=n&&n.e;for(var X of a.values())Te(X.e);a.clear()}function Ie(r,t,e,a){Ye(r.v,t),r.i=e}function fe(r,t,e,a,l,o,c,p,w,d,E){var T=(w&Ke)!==0,v=(w&Qe)===0,h=T?v?z(l,!1,!1):be(l):l,n=(w&Xe)===0?c:be(c),g={i:n,v:h,k:o,a:null,e:null,prev:e,next:a};try{if(r===null){var u=document.createDocumentFragment();u.append(r=Se())}return g.e=ce(()=>p(r,h,n,d),H),g.e.prev=e&&e.e,g.e.next=a&&a.e,e===null?E||(t.first=g):(e.next=g,e.e.next=g.e),a!==null&&(a.prev=g,a.e.prev=g.e),g}finally{}}function oe(r,t,e){for(var a=r.next?r.next.e.nodes_start:e,l=t?t.e.nodes_start:e,o=r.e.nodes_start;o!==null&&o!==a;){var c=We(o);l.before(o),o=c}}function P(r,t,e){t===null?r.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}const we=[...` 	
\r\fÂ \v\uFEFF`];function ut(r,t,e){var a=""+r;if(e){for(var l in e)if(e[l])a=a?a+" "+l:l;else if(a.length)for(var o=l.length,c=0;(c=a.indexOf(l,c))>=0;){var p=c+o;(c===0||we.includes(a[c-1]))&&(p===a.length||we.includes(a[p]))?a=(c===0?"":a.substring(0,c))+a.substring(p+1):c=p}}return a===""?null:a}function vt(r,t){return r==null?null:String(r)}function ee(r,t,e,a,l,o){var c=r.__className;if(H||c!==e||c===void 0){var p=ut(e,a,o);(!H||p!==r.getAttribute("class"))&&(p==null?r.removeAttribute("class"):r.className=p),r.__className=e}else if(o&&l!==o)for(var w in o){var d=!!o[w];(l==null||d!==!!l[w])&&r.classList.toggle(w,d)}return o}function Z(r,t,e,a){var l=r.__style;if(H||l!==t){var o=vt(t);(!H||o!==r.getAttribute("style"))&&(o==null?r.removeAttribute("style"):r.style.cssText=o),r.__style=t}return a}const ht=Symbol("is custom element"),gt=Symbol("is html");function Y(r,t,e,a){var l=pt(r);H&&(l[t]=r.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&r.nodeName==="LINK")||l[t]!==(l[t]=e)&&(t==="loading"&&(r[tt]=e),e==null?r.removeAttribute(t):typeof e!="string"&&_t(r).includes(t)?r[t]=e:r.setAttribute(t,e))}function pt(r){return r.__attributes??={[ht]:r.nodeName.includes("-"),[gt]:r.namespaceURI===rt}}var ye=new Map;function _t(r){var t=r.getAttribute("is")||r.nodeName,e=ye.get(t);if(e)return e;ye.set(t,e=[]);for(var a,l=r,o=Element.prototype;o!==l;){a=nt(l);for(var c in a)a[c].set&&e.push(c);l=at(l)}return e}var mt=K('<div class="square svelte-gxsx5p"></div>');function Ne(r,t){let e=G(t,"color",8,"#000");var a=mt();W(()=>Z(a,`--color: ${e()??""}`)),B(r,a)}var bt=K('<div class="circle svelte-r5z0cw"></div>');function ke(r,t){let e=G(t,"color",8,"#000");var a=bt();W(()=>Z(a,`--color: ${e()??""}`)),B(r,a)}var wt=K('<div class="arch-container svelte-1isloo0"><svg width="100%" height="100%" viewBox="0 0 100 100" preserveAspectRatio="none"><circle cx="0" cy="0" r="100"></circle></svg></div>');function De(r,t){let e=G(t,"color",8,"#000"),a=G(t,"rotation",8,0);var l=wt(),o=R(l),c=R(o);k(o),k(l),W(()=>{Z(l,`transform: rotate(${a()*90}deg);`),Y(c,"fill",e())}),B(r,l)}var yt=K('<div class="cell svelte-1w4104m" role="button" tabindex="0"><!></div>'),Mt=K('<div class="container svelte-1w4104m"><div class="grid svelte-1w4104m"></div></div>');function Me(r,t){de(t,!1);let e=G(t,"paintMode",8,!1);function a(h){const n=i(d)[h];if(!n)return E(h);const{shape:g,color:u}=n;if(g===p()&&u===w())return;const A=[h],f=new Set;for(;A.length;){const s=A.pop();if(s===void 0||f.has(s))continue;f.add(s);const _=i(d)[s];if(!_||_.shape!==g||_.color!==u)continue;se(d,i(d)[s]={shape:p(),color:w(),rotation:0});const m=s%o(),b=Math.floor(s/o());m>0&&A.push(s-1),m<o()-1&&A.push(s+1),b>0&&A.push(s-o()),b<c()-1&&A.push(s+o())}F(d,[...i(d)])}let l=G(t,"grid",8,null),o=G(t,"width",8,32),c=G(t,"height",8,32),p=G(t,"selectedShape",8,"square"),w=G(t,"selectedColor",8,"#000000"),d=z();function E(h){const n=i(d)[h];n&&n.shape==="arch"&&n.color===w()?se(d,i(d)[h]={...n,rotation:(n.rotation+1)%4}):se(d,i(d)[h]={shape:p(),color:w(),rotation:0}),F(d,[...i(d)])}it(()=>(le(l()),le(o()),le(c())),()=>{F(d,l()||Array(o()*c()).fill(null))}),st(),ve();var T=Mt(),v=R(T);Ce(v,5,()=>i(d),xe,(h,n,g)=>{var u=yt(),A=R(u);{var f=s=>{var _=ne(),m=ie(_);{var b=y=>{Ne(y,{get color(){return i(n),Q(()=>i(n).color)}})},S=y=>{var M=ne(),x=ie(M);{var D=N=>{ke(N,{get color(){return i(n),Q(()=>i(n).color)}})},L=N=>{var O=ne(),X=ie(O);{var C=I=>{De(I,{get color(){return i(n),Q(()=>i(n).color)},get rotation(){return i(n),Q(()=>i(n).rotation)}})};J(X,I=>{i(n),Q(()=>i(n).shape==="arch")&&I(C)},!0)}B(N,O)};J(x,N=>{i(n),Q(()=>i(n).shape==="circle")?N(D):N(L,!1)},!0)}B(y,M)};J(m,y=>{i(n),Q(()=>i(n).shape==="square")?y(b):y(S,!1)})}B(s,_)};J(A,s=>{i(n)&&s(f)})}k(u),j("click",u,()=>e()?a(g):E(g)),j("keydown",u,s=>(e()?a(g):E(g))&&s.key==="Enter"),B(h,u)}),k(v),k(T),W(()=>Z(v,`--width: ${o()??""}; --height: ${c()??""};`)),B(r,T),ue()}var St=K('<button type="button"></button>'),At=K('<div class="toolbar svelte-1ld6r3r"><div class="shapes svelte-1ld6r3r" style="display: flex; align-items: center;"><button aria-label="Square" style="width: 2.5rem; height: 2.5rem; padding: 0; display: inline-flex; align-items: center; justify-content: center;"><!></button> <button aria-label="Circle" style="width: 2.5rem; height: 2.5rem; padding: 0; display: inline-flex; align-items: center; justify-content: center;"><!></button> <button aria-label="Arch" style="width: 2.5rem; height: 2.5rem; padding: 0; display: inline-flex; align-items: center; justify-content: center;"><!></button> <button type="button" aria-label="Paint roller tool"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="6" y="4" width="10" height="4" rx="1.5"></rect><path d="M16 6v4c0 1-1 2-2 2H10c-1 0-2-1-2-2V6"></path><rect x="11" y="14" width="2" height="5" rx="1"></rect><path d="M12 12v2"></path></svg></button></div> <div class="colors" style="display: flex; gap: 0.25rem; align-items: center;"></div> <div class="image-upload"><input type="file" accept="image/png, image/jpeg"/></div></div>');function Et(r,t){de(t,!1);let e=z(!1);function a(){F(e,!i(e)),c("paintModeToggled",{paintMode:i(e)})}const l=["#ffffff","#000000","#f4d23e","#e4a9a8","#e3000b","#ff9c08","#008f9b","#0055bf","#a5ca18","#237841","#b4004e","#f785b1","#fbe870","#f5cd2f","#c870a0","#e4e7e7"];function o(C){F(w,C),c("colorSelected",{color:C})}const c=ot();let p=z("square"),w=z("#000000");function d(C){F(p,C),c("shapeSelected",{shape:C})}function E(C){const I=C.target,q=I.files&&I.files[0];if(q){const U=new FileReader;U.onload=()=>{c("imageUploaded",{src:U.result})},U.readAsDataURL(q)}}ve();var T=At(),v=R(T),h=R(v);let n;var g=R(h);Ne(g,{get color(){return i(w)}}),k(h);var u=V(h,2);let A;var f=R(u);ke(f,{get color(){return i(w)}}),k(u);var s=V(u,2);let _;var m=R(s);De(m,{get color(){return i(w)},rotation:0}),k(s);var b=V(s,2);let S;var y=R(b),M=R(y),x=V(M),D=V(x),L=V(D);k(y),k(b),k(v);var N=V(v,2);Ce(N,5,()=>l,xe,(C,I)=>{var q=St();W(()=>{Z(q,`width: 1.5rem; height: 1.5rem; background: ${i(I)??""}; border: 2px solid ${i(w)===i(I)?"#333":"#ccc"}; border-radius: 0.25rem; cursor: pointer;`),Y(q,"aria-label",i(I))}),j("click",q,()=>o(i(I))),B(C,q)}),k(N);var O=V(N,2),X=R(O);k(O),k(T),W((C,I,q,U)=>{n=ee(h,1,"svelte-1ld6r3r",null,n,C),A=ee(u,1,"svelte-1ld6r3r",null,A,I),_=ee(s,1,"svelte-1ld6r3r",null,_,q),Z(b,`width: 2.5rem; height: 2.5rem; margin-left: 0.5rem; display: inline-flex; align-items: center; justify-content: center; border: 2px solid ${i(e)?"#333":"#ccc"}; background: ${i(e)?"#f4d23e":"#fff"}; border-radius: 0.5rem; cursor: pointer;`),S=ee(b,1,"svelte-1ld6r3r",null,S,U),Y(y,"stroke",i(e)?"#333":"#888"),Y(M,"fill",i(e)?"#f4d23e":"#fff"),Y(M,"stroke",i(e)?"#333":"#888"),Y(x,"stroke",i(e)?"#333":"#888"),Y(D,"fill",i(e)?"#f4d23e":"#fff"),Y(D,"stroke",i(e)?"#333":"#888"),Y(L,"stroke",i(e)?"#333":"#888")},[()=>({selected:i(p)==="square"}),()=>({selected:i(p)==="circle"}),()=>({selected:i(p)==="arch"}),()=>({active:i(e)})]),j("click",h,()=>d("square")),j("click",u,()=>d("circle")),j("click",s,()=>d("arch")),j("click",b,a),j("change",X,E),B(r,T),ue()}var Tt=K('<main class="svelte-1uha8ag"><!> <!></main>');function qt(r,t){de(t,!1);let e=z("square"),a=z("#000000"),l=z(null),o=z(!1);function c(f){F(e,f.detail.shape)}function p(f){F(a,f.detail.color)}function w(f){const s=new Image;s.src=f.detail.src,s.onload=()=>{const _=document.createElement("canvas"),m=_.getContext("2d"),b=32,S=32;_.width=b,_.height=S,m.drawImage(s,0,0,b,S);const y=m.getImageData(0,0,b,S).data,M=[];for(let x=0;x<y.length;x+=4){const D=x/4,L=D%b,N=Math.floor(D/b),O=y[x],X=y[x+1],C=y[x+2],I=(O+X+C)/3;let q=v(I),U=0;const he=N===0,ge=N===S-1,pe=L===0,_e=L===b-1;q==="arch"&&(he||ge||pe||_e)?he?U=2:ge?U=0:pe?U=1:_e&&(U=3):q==="arch"&&(q=I<128?"square":"circle");const qe=T(O,X,C);M.push({shape:q,color:qe,rotation:U})}F(l,M)}}const d=["#ffffff","#000000","#f4d23e","#e4a9a8","#e3000b","#ff9c08","#008f9b","#0055bf","#a5ca18","#237841","#b4004e","#f785b1","#fbe870","#f5cd2f","#c870a0","#e4e7e7"];function E(f){f=f.replace(/^#/,""),f.length===3&&(f=f.split("").map(_=>_+_).join(""));const s=parseInt(f,16);return{r:s>>16&255,g:s>>8&255,b:s&255}}function T(f,s,_){let m=d[0],b=1/0;for(const S of d){const y=E(S),M=Math.sqrt(Math.pow(f-y.r,2)+Math.pow(s-y.g,2)+Math.pow(_-y.b,2));M<b&&(b=M,m=S)}return m}function v(f){return f<85?"square":f<170?"arch":"circle"}ve();var h=Tt();ct(f=>{lt.title="Dotsly"});var n=R(h);Et(n,{$$events:{shapeSelected:c,colorSelected:p,imageUploaded:w,paintModeToggled:f=>F(o,f.detail.paintMode)}});var g=V(n,2);{var u=f=>{Me(f,{width:32,height:32,get selectedShape(){return i(e)},get selectedColor(){return i(a)},get grid(){return i(l)},get paintMode(){return i(o)}})},A=f=>{Me(f,{width:32,height:32,get selectedShape(){return i(e)},get selectedColor(){return i(a)},get paintMode(){return i(o)}})};J(g,f=>{i(l)?f(u):f(A,!1)})}k(h),B(r,h),ue()}export{qt as component};
