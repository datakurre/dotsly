import"../chunks/DsnmJJEf.js";import"../chunks/BBcziVKK.js";import{y as Z,q as I,ay as Ee,A as pe,v as ye,o as Ce,g as h,L as Te,w as Ie,H as Me,x as ue,z as $,I as F,ad as Ne,aG as De,B as ne,D as qe,C as V,aD as be,av as Re,a4 as B,aa as de,ac as ke,F as we,G as Le,aR as xe,aS as J,al as Se,aT as Ue,aU as He,ar as Oe,aV as Be,aC as Ge,aW as Ve,Q as Ye,aX as Fe,aY as ze,aZ as Pe,a_ as We,a$ as Xe,b0 as Ke,b1 as Qe,a6 as Ze,b as U,a0 as $e,b2 as Je,i as G,t as W,k as q,m as x,n as R,p as ce,b3 as je,b4 as er,l as fe,N as H,e as j,_ as ee,j as re,b5 as he,s as z,b6 as rr}from"../chunks/Bq4IH278.js";import{e as O,c as ar,a as tr}from"../chunks/C0pNlHnU.js";import{p as L,i as P}from"../chunks/CHGr5rdI.js";import{i as ve}from"../chunks/BiLexOE7.js";function lr(e,a){return a}function sr(e,a,r){for(var t=e.items,l=[],n=a.length,o=0;o<n;o++)Be(a[o].e,l,!0);var c=n>0&&l.length===0&&r!==null;if(c){var b=r.parentNode;Ge(b),b.append(r),t.clear(),D(e,a[0].prev,a[n-1].next)}Ve(l,()=>{for(var m=0;m<n;m++){var S=a[m];c||(t.delete(S.k),D(e,S.prev,S.next)),Se(S.e,!c)}})}function nr(e,a,r,t,l,n=null){var o=e,c={flags:a,items:new Map,first:null};{var b=e;o=I?Z(Ee(b)):b.appendChild(pe())}I&&ye();var m=null,S=!1,E=new Map,s=Te(()=>{var i=r();return Re(i)?i:i==null?[]:be(i)}),p,f;function _(){ir(f,p,c,E,o,l,a,t,r),n!==null&&(p.length===0?m?we(m):m=ne(()=>n(o)):m!==null&&Le(m,()=>{m=null}))}Ce(()=>{f??=Ye,p=h(s);var i=p.length;if(S&&i===0)return;S=i===0;let w=!1;if(I){var A=Ie(o)===Me;A!==(i===0)&&(o=ue(),Z(o),$(!1),w=!0)}if(I){for(var d=null,u,v=0;v<i;v++){if(F.nodeType===Ne&&F.data===De){o=F,w=!0,$(!1);break}var g=p[v],y=t(g,v);u=ie(F,c,d,null,g,y,v,l,a,r),c.items.set(y,u),d=u}i>0&&Z(ue())}if(I)i===0&&n&&(m=ne(()=>n(o)));else if(qe()){var M=new Set,C=V;for(v=0;v<i;v+=1){g=p[v],y=t(g,v);var k=c.items.get(y)??E.get(y);k?Ae(k,g,v):(u=ie(null,c,null,null,g,y,v,l,a,r,!0),E.set(y,u)),M.add(y)}for(const[T,N]of c.items)M.has(T)||C.skipped_effects.add(N.e);C.add_callback(_)}else _();w&&$(!0),h(s)}),I&&(o=F)}function ir(e,a,r,t,l,n,o,c,b){var m=a.length,S=r.items,E=r.first,s=E,p,f=null,_=[],i=[],w,A,d,u;for(u=0;u<m;u+=1){if(w=a[u],A=c(w,u),d=S.get(A),d===void 0){var v=t.get(A);if(v!==void 0){t.delete(A),S.set(A,v);var g=f?f.next:s;D(r,f,v),D(r,v,g),ae(v,g,l),f=v}else{var y=s?s.e.nodes_start:l;f=ie(y,r,f,f===null?r.first:f.next,w,A,u,n,o,b)}S.set(A,f),_=[],i=[],s=f.next;continue}if(Ae(d,w,u),(d.e.f&J)!==0&&we(d.e),d!==s){if(p!==void 0&&p.has(d)){if(_.length<i.length){var M=i[0],C;f=M.prev;var k=_[0],T=_[_.length-1];for(C=0;C<_.length;C+=1)ae(_[C],M,l);for(C=0;C<i.length;C+=1)p.delete(i[C]);D(r,k.prev,T.next),D(r,f,k),D(r,T,M),s=M,f=T,u-=1,_=[],i=[]}else p.delete(d),ae(d,s,l),D(r,d.prev,d.next),D(r,d,f===null?r.first:f.next),D(r,f,d),f=d;continue}for(_=[],i=[];s!==null&&s.k!==A;)(s.e.f&J)===0&&(p??=new Set).add(s),i.push(s),s=s.next;if(s===null)continue;d=s}_.push(d),f=d,s=d.next}if(s!==null||p!==void 0){for(var N=p===void 0?[]:be(p);s!==null;)(s.e.f&J)===0&&N.push(s),s=s.next;var K=N.length;if(K>0){var Q=m===0?l:null;sr(r,N,Q)}}e.first=r.first&&r.first.e,e.last=f&&f.e;for(var Y of t.values())Se(Y.e);t.clear()}function Ae(e,a,r,t){ke(e.v,a),e.i=r}function ie(e,a,r,t,l,n,o,c,b,m,S){var E=(b&Ue)!==0,s=(b&He)===0,p=E?s?B(l,!1,!1):de(l):l,f=(b&xe)===0?o:de(o),_={i:f,v:p,k:n,a:null,e:null,prev:r,next:t};try{if(e===null){var i=document.createDocumentFragment();i.append(e=pe())}return _.e=ne(()=>c(e,p,f,m),I),_.e.prev=r&&r.e,_.e.next=t&&t.e,r===null?S||(a.first=_):(r.next=_,r.e.next=_.e),t!==null&&(t.prev=_,t.e.prev=_.e),_}finally{}}function ae(e,a,r){for(var t=e.next?e.next.e.nodes_start:r,l=a?a.e.nodes_start:r,n=e.e.nodes_start;n!==null&&n!==t;){var o=Oe(n);l.before(n),n=o}}function D(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}const _e=[...` 	
\r\fÂ \v\uFEFF`];function or(e,a,r){var t=""+e;if(r){for(var l in r)if(r[l])t=t?t+" "+l:l;else if(t.length)for(var n=l.length,o=0;(o=t.indexOf(l,o))>=0;){var c=o+n;(o===0||_e.includes(t[o-1]))&&(c===t.length||_e.includes(t[c]))?t=(o===0?"":t.substring(0,o))+t.substring(c+1):o=c}}return t===""?null:t}function cr(e,a){return e==null?null:String(e)}function te(e,a,r,t,l,n){var o=e.__className;if(I||o!==r||o===void 0){var c=or(r,t,n);(!I||c!==e.getAttribute("class"))&&(c==null?e.removeAttribute("class"):e.className=c),e.__className=r}else if(n&&l!==n)for(var b in n){var m=!!n[b];(l==null||m!==!!l[b])&&e.classList.toggle(b,m)}return n}function X(e,a,r,t){var l=e.__style;if(I||l!==a){var n=cr(a);(!I||n!==e.getAttribute("style"))&&(n==null?e.removeAttribute("style"):e.style.cssText=n),e.__style=a}return t}const fr=Symbol("is custom element"),vr=Symbol("is html");function ur(e){if(I){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var t=e.value;oe(e,"value",null),e.value=t}if(e.hasAttribute("checked")){var l=e.checked;oe(e,"checked",null),e.checked=l}}};e.__on_r=r,Fe(r),ze()}}function oe(e,a,r,t){var l=dr(e);I&&(l[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||l[a]!==(l[a]=r)&&(a==="loading"&&(e[Pe]=r),r==null?e.removeAttribute(a):typeof r!="string"&&hr(e).includes(a)?e[a]=r:e.setAttribute(a,r))}function dr(e){return e.__attributes??={[fr]:e.nodeName.includes("-"),[vr]:e.namespaceURI===We}}var ge=new Map;function hr(e){var a=e.getAttribute("is")||e.nodeName,r=ge.get(a);if(r)return r;ge.set(a,r=[]);for(var t,l=e,n=Element.prototype;n!==l;){t=Ke(l);for(var o in t)t[o].set&&r.push(o);l=Xe(l)}return r}function _r(e,a,r=a){var t=new WeakSet;Qe(e,"input",async l=>{var n=l?e.defaultValue:e.value;if(n=le(e)?se(n):n,r(n),V!==null&&t.add(V),await Ze(),n!==(n=a())){var o=e.selectionStart,c=e.selectionEnd;e.value=n??"",c!==null&&(e.selectionStart=o,e.selectionEnd=Math.min(c,e.value.length))}}),(I&&e.defaultValue!==e.value||U(a)==null&&e.value)&&(r(le(e)?se(e.value):e.value),V!==null&&t.add(V)),$e(()=>{var l=a();if(e===document.activeElement){var n=Je??V;if(t.has(n))return}le(e)&&l===se(e.value)||e.type==="date"&&!l&&!e.value||l!==e.value&&(e.value=l??"")})}function le(e){var a=e.type;return a==="number"||a==="range"}function se(e){return e===""?null:+e}var gr=G('<div class="square svelte-gxsx5p"></div>');function mr(e,a){let r=L(a,"color",8,"#000");var t=gr();W(()=>X(t,`--color: ${r()??""}`)),q(e,t)}var pr=G('<div class="circle svelte-r5z0cw"></div>');function br(e,a){let r=L(a,"color",8,"#000");var t=pr();W(()=>X(t,`--color: ${r()??""}`)),q(e,t)}var wr=G('<div class="arch-container svelte-1isloo0"><svg width="100%" height="100%" viewBox="0 0 100 100" preserveAspectRatio="none"><circle cx="0" cy="0" r="100"></circle></svg></div>');function Sr(e,a){let r=L(a,"color",8,"#000"),t=L(a,"rotation",8,0);var l=wr(),n=x(l),o=x(n);R(n),R(l),W(()=>{X(l,`transform: rotate(${t()*90}deg);`),oe(o,"fill",r())}),q(e,l)}var Ar=G('<div class="cell svelte-1w4104m" role="button" tabindex="0"><!></div>'),Er=G('<div class="container svelte-1w4104m"><div class="grid svelte-1w4104m"></div></div>');function me(e,a){ce(a,!1);let r=L(a,"grid",8,null),t=L(a,"width",8,16),l=L(a,"height",8,16),n=L(a,"selectedShape",8,"square"),o=L(a,"selectedColor",8,"#000000"),c=B();function b(E){const s=h(c)[E];s&&s.shape==="arch"&&s.color===o()?he(c,h(c)[E]={...s,rotation:(s.rotation+1)%4}):he(c,h(c)[E]={shape:n(),color:o(),rotation:0}),H(c,[...h(c)])}je(()=>(j(r()),j(t()),j(l())),()=>{H(c,r()||Array(t()*l()).fill(null))}),er(),ve();var m=Er(),S=x(m);nr(S,5,()=>h(c),lr,(E,s,p)=>{var f=Ar(),_=x(f);{var i=w=>{var A=ee(),d=re(A);{var u=g=>{mr(g,{get color(){return h(s),U(()=>h(s).color)}})},v=g=>{var y=ee(),M=re(y);{var C=T=>{br(T,{get color(){return h(s),U(()=>h(s).color)}})},k=T=>{var N=ee(),K=re(N);{var Q=Y=>{Sr(Y,{get color(){return h(s),U(()=>h(s).color)},get rotation(){return h(s),U(()=>h(s).rotation)}})};P(K,Y=>{h(s),U(()=>h(s).shape==="arch")&&Y(Q)},!0)}q(T,N)};P(M,T=>{h(s),U(()=>h(s).shape==="circle")?T(C):T(k,!1)},!0)}q(g,y)};P(d,g=>{h(s),U(()=>h(s).shape==="square")?g(u):g(v,!1)})}q(w,A)};P(_,w=>{h(s)&&w(i)})}R(f),O("click",f,()=>b(p)),O("keydown",f,w=>w.key==="Enter"&&b(p)),q(E,f)}),R(S),R(m),W(()=>X(S,`--width: ${t()??""}; --height: ${l()??""};`)),q(e,m),fe()}var yr=G('<div class="toolbar svelte-1ld6r3r"><div class="shapes svelte-1ld6r3r"><button>Square</button> <button>Circle</button> <button>Arch</button></div> <div class="colors"><input type="color"/></div> <div class="image-upload"><input type="file" accept="image/png, image/jpeg"/></div></div>');function Cr(e,a){ce(a,!1);const r=ar();let t=B("square"),l=B("#000000");function n(u){H(t,u),r("shapeSelected",{shape:u})}function o(u){const v=u.target;H(l,v.value),r("colorSelected",{color:h(l)})}function c(u){const v=u.target,g=v.files&&v.files[0];if(g){const y=new FileReader;y.onload=()=>{r("imageUploaded",{src:y.result})},y.readAsDataURL(g)}}ve();var b=yr(),m=x(b),S=x(m);let E;var s=z(S,2);let p;var f=z(s,2);let _;R(m);var i=z(m,2),w=x(i);ur(w),R(i);var A=z(i,2),d=x(A);R(A),R(b),W((u,v,g)=>{E=te(S,1,"svelte-1ld6r3r",null,E,u),p=te(s,1,"svelte-1ld6r3r",null,p,v),_=te(f,1,"svelte-1ld6r3r",null,_,g)},[()=>({selected:h(t)==="square"}),()=>({selected:h(t)==="circle"}),()=>({selected:h(t)==="arch"})]),O("click",S,()=>n("square")),O("click",s,()=>n("circle")),O("click",f,()=>n("arch")),_r(w,()=>h(l),u=>H(l,u)),O("input",w,o),O("change",d,c),q(e,b),fe()}var Tr=G('<main class="svelte-1uha8ag"><!> <!></main>');function kr(e,a){ce(a,!1);let r=B("square"),t=B("#000000"),l=B(null);function n(i){H(r,i.detail.shape)}function o(i){H(t,i.detail.color)}function c(i){const w=new Image;w.src=i.detail.src,w.onload=()=>{const A=document.createElement("canvas"),d=A.getContext("2d");A.width=16,A.height=16,d.drawImage(w,0,0,16,16);const u=d.getImageData(0,0,16,16).data,v=[];for(let g=0;g<u.length;g+=4){const y=u[g],M=u[g+1],C=u[g+2],k=(y+M+C)/3,T=m(y,M,C),N=S(k);v.push({shape:N,color:T,rotation:0})}H(l,v)}}const b=[{r:0,g:0,b:0},{r:255,g:255,b:255},{r:255,g:0,b:0},{r:0,g:255,b:0},{r:0,g:0,b:255}];function m(i,w,A){let d=b[0],u=1/0;for(const v of b){const g=Math.sqrt(Math.pow(i-v.r,2)+Math.pow(w-v.g,2)+Math.pow(A-v.b,2));g<u&&(u=g,d=v)}return`rgb(${d.r}, ${d.g}, ${d.b})`}function S(i){return i<85?"square":i<170?"arch":"circle"}ve();var E=Tr();tr(i=>{rr.title="Dotsly"});var s=x(E);Cr(s,{$$events:{shapeSelected:n,colorSelected:o,imageUploaded:c}});var p=z(s,2);{var f=i=>{me(i,{width:16,height:16,get selectedShape(){return h(r)},get selectedColor(){return h(t)},get grid(){return h(l)}})},_=i=>{me(i,{width:16,height:16,get selectedShape(){return h(r)},get selectedColor(){return h(t)}})};P(p,i=>{h(l)?i(f):i(_,!1)})}R(E),q(e,E),fe()}export{kr as component};
