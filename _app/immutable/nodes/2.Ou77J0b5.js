import"../chunks/DsnmJJEf.js";import"../chunks/DiWgoKHH.js";import{A as be,o as Ie,y as te,q as R,ay as Ne,v as ke,g as n,Q as De,w as qe,H as Re,x as he,z as re,I as j,ad as Le,aG as He,B as ce,D as Ue,C as Oe,ac as Be,a4 as V,aa as ge,aD as we,av as Pe,aR as Ge,F as ye,G as Fe,aS as Ve,aT as Ye,aU as ae,al as Me,ar as $e,aV as ze,aC as Xe,aW as Ke,N as Qe,aX as We,aY as Ze,aZ as je,a_ as Je,i as $,t as K,k as H,m as q,n as C,p as de,a$ as et,b0 as tt,_ as ne,j as ie,b as X,l as ue,b1 as se,M as B,e as le,s as G,b2 as rt}from"../chunks/CezrgYUq.js";import{e as Y,c as at,a as nt}from"../chunks/DfvYGNSv.js";import{p as O,i as J}from"../chunks/CTiD2ntr.js";import{i as ve}from"../chunks/m5EpKNiI.js";function Se(r,t){return t}function it(r,t,e){for(var a=r.items,s=[],l=t.length,c=0;c<l;c++)ze(t[c].e,s,!0);var p=l>0&&s.length===0&&e!==null;if(p){var b=e.parentNode;Xe(b),b.append(e),a.clear(),U(r,t[0].prev,t[l-1].next)}Ke(s,()=>{for(var f=0;f<l;f++){var S=t[f];p||(a.delete(S.k),U(r,S.prev,S.next)),Me(S.e,!p)}})}function Ae(r,t,e,a,s,l=null){var c=r,p={flags:t,items:new Map,first:null};{var b=r;c=R?te(Ne(b)):b.appendChild(be())}R&&ke();var f=null,S=!1,x=new Map,u=De(()=>{var v=e();return Pe(v)?v:v==null?[]:we(v)}),h,i;function g(){st(i,h,p,x,c,s,t,a,e),l!==null&&(h.length===0?f?ye(f):f=ce(()=>l(c)):f!==null&&Fe(f,()=>{f=null}))}Ie(()=>{i??=Qe,h=n(u);var v=h.length;if(S&&v===0)return;S=v===0;let d=!1;if(R){var M=qe(c)===Re;M!==(v===0)&&(c=he(),te(c),re(!1),d=!0)}if(R){for(var o=null,m,_=0;_<v;_++){if(j.nodeType===Le&&j.data===He){c=j,d=!0,re(!1);break}var w=h[_],y=a(w,_);m=fe(j,p,o,null,w,y,_,s,t,e),p.items.set(y,m),o=m}v>0&&te(he())}if(R)v===0&&l&&(f=ce(()=>l(c)));else if(Ue()){var A=new Set,E=Oe;for(_=0;_<v;_+=1){w=h[_],y=a(w,_);var I=p.items.get(y)??x.get(y);I?Ee(I,w,_):(m=fe(null,p,null,null,w,y,_,s,t,e,!0),x.set(y,m)),A.add(y)}for(const[N,L]of p.items)A.has(N)||E.skipped_effects.add(L.e);E.add_callback(g)}else g();d&&re(!0),n(u)}),R&&(c=j)}function st(r,t,e,a,s,l,c,p,b){var f=t.length,S=e.items,x=e.first,u=x,h,i=null,g=[],v=[],d,M,o,m;for(m=0;m<f;m+=1){if(d=t[m],M=p(d,m),o=S.get(M),o===void 0){var _=a.get(M);if(_!==void 0){a.delete(M),S.set(M,_);var w=i?i.next:u;U(e,i,_),U(e,_,w),oe(_,w,s),i=_}else{var y=u?u.e.nodes_start:s;i=fe(y,e,i,i===null?e.first:i.next,d,M,m,l,c,b)}S.set(M,i),g=[],v=[],u=i.next;continue}if(Ee(o,d,m),(o.e.f&ae)!==0&&ye(o.e),o!==u){if(h!==void 0&&h.has(o)){if(g.length<v.length){var A=v[0],E;i=A.prev;var I=g[0],N=g[g.length-1];for(E=0;E<g.length;E+=1)oe(g[E],A,s);for(E=0;E<v.length;E+=1)h.delete(v[E]);U(e,I.prev,N.next),U(e,i,I),U(e,N,A),u=A,i=N,m-=1,g=[],v=[]}else h.delete(o),oe(o,u,s),U(e,o.prev,o.next),U(e,o,i===null?e.first:i.next),U(e,i,o),i=o;continue}for(g=[],v=[];u!==null&&u.k!==M;)(u.e.f&ae)===0&&(h??=new Set).add(u),v.push(u),u=u.next;if(u===null)continue;o=u}g.push(o),i=o,u=o.next}if(u!==null||h!==void 0){for(var L=h===void 0?[]:we(h);u!==null;)(u.e.f&ae)===0&&L.push(u),u=u.next;var T=L.length;if(T>0){var z=f===0?s:null;it(e,L,z)}}r.first=e.first&&e.first.e,r.last=i&&i.e;for(var W of a.values())Me(W.e);a.clear()}function Ee(r,t,e,a){Be(r.v,t),r.i=e}function fe(r,t,e,a,s,l,c,p,b,f,S){var x=(b&Ve)!==0,u=(b&Ye)===0,h=x?u?V(s,!1,!1):ge(s):s,i=(b&Ge)===0?c:ge(c),g={i,v:h,k:l,a:null,e:null,prev:e,next:a};try{if(r===null){var v=document.createDocumentFragment();v.append(r=be())}return g.e=ce(()=>p(r,h,i,f),R),g.e.prev=e&&e.e,g.e.next=a&&a.e,e===null?S||(t.first=g):(e.next=g,e.e.next=g.e),a!==null&&(a.prev=g,a.e.prev=g.e),g}finally{}}function oe(r,t,e){for(var a=r.next?r.next.e.nodes_start:e,s=t?t.e.nodes_start:e,l=r.e.nodes_start;l!==null&&l!==a;){var c=$e(l);s.before(l),l=c}}function U(r,t,e){t===null?r.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}const pe=[...` 	
\r\fÂ \v\uFEFF`];function lt(r,t,e){var a=""+r;if(e){for(var s in e)if(e[s])a=a?a+" "+s:s;else if(a.length)for(var l=s.length,c=0;(c=a.indexOf(s,c))>=0;){var p=c+l;(c===0||pe.includes(a[c-1]))&&(p===a.length||pe.includes(a[p]))?a=(c===0?"":a.substring(0,c))+a.substring(p+1):c=p}}return a===""?null:a}function ot(r,t){return r==null?null:String(r)}function ee(r,t,e,a,s,l){var c=r.__className;if(R||c!==e||c===void 0){var p=lt(e,a,l);(!R||p!==r.getAttribute("class"))&&(p==null?r.removeAttribute("class"):r.className=p),r.__className=e}else if(l&&s!==l)for(var b in l){var f=!!l[b];(s==null||f!==!!s[b])&&r.classList.toggle(b,f)}return l}function Q(r,t,e,a){var s=r.__style;if(R||s!==t){var l=ot(t);(!R||l!==r.getAttribute("style"))&&(l==null?r.removeAttribute("style"):r.style.cssText=l),r.__style=t}return a}const ct=Symbol("is custom element"),ft=Symbol("is html");function F(r,t,e,a){var s=dt(r);R&&(s[t]=r.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&r.nodeName==="LINK")||s[t]!==(s[t]=e)&&(t==="loading"&&(r[We]=e),e==null?r.removeAttribute(t):typeof e!="string"&&ut(r).includes(t)?r[t]=e:r.setAttribute(t,e))}function dt(r){return r.__attributes??={[ct]:r.nodeName.includes("-"),[ft]:r.namespaceURI===Ze}}var _e=new Map;function ut(r){var t=r.getAttribute("is")||r.nodeName,e=_e.get(t);if(e)return e;_e.set(t,e=[]);for(var a,s=r,l=Element.prototype;l!==s;){a=Je(s);for(var c in a)a[c].set&&e.push(c);s=je(s)}return e}var vt=$('<div class="square svelte-gxsx5p"></div>');function xe(r,t){let e=O(t,"color",8,"#000");var a=vt();K(()=>Q(a,`--color: ${e()??""}`)),H(r,a)}var ht=$('<div class="circle svelte-r5z0cw"></div>');function Ce(r,t){let e=O(t,"color",8,"#000");var a=ht();K(()=>Q(a,`--color: ${e()??""}`)),H(r,a)}var gt=$('<div class="arch-container svelte-1isloo0"><svg width="100%" height="100%" viewBox="0 0 100 100" preserveAspectRatio="none"><circle cx="0" cy="0" r="100"></circle></svg></div>');function Te(r,t){let e=O(t,"color",8,"#000"),a=O(t,"rotation",8,0);var s=gt(),l=q(s),c=q(l);C(l),C(s),K(()=>{Q(s,`transform: rotate(${a()*90}deg);`),F(c,"fill",e())}),H(r,s)}var pt=$('<div class="cell svelte-1w4104m" role="button" tabindex="0"><!></div>'),_t=$('<div class="container svelte-1w4104m"><div class="grid svelte-1w4104m"></div></div>');function me(r,t){de(t,!1);let e=O(t,"paintMode",8,!1);function a(h){const i=n(f)[h];if(!i)return S(h);const{shape:g,color:v}=i;if(g===p()&&v===b())return;const d=[h],M=new Set;for(;d.length;){const o=d.pop();if(o===void 0||M.has(o))continue;M.add(o);const m=n(f)[o];if(!m||m.shape!==g||m.color!==v)continue;se(f,n(f)[o]={shape:p(),color:b(),rotation:0});const _=o%l(),w=Math.floor(o/l());_>0&&d.push(o-1),_<l()-1&&d.push(o+1),w>0&&d.push(o-l()),w<c()-1&&d.push(o+l())}B(f,[...n(f)])}let s=O(t,"grid",8,null),l=O(t,"width",8,32),c=O(t,"height",8,32),p=O(t,"selectedShape",8,"square"),b=O(t,"selectedColor",8,"#000000"),f=V();function S(h){const i=n(f)[h];i&&i.shape==="arch"&&i.color===b()?se(f,n(f)[h]={...i,rotation:(i.rotation+1)%4}):se(f,n(f)[h]={shape:p(),color:b(),rotation:0}),B(f,[...n(f)])}et(()=>(le(s()),le(l()),le(c())),()=>{B(f,s()||Array(l()*c()).fill(null))}),tt(),ve();var x=_t(),u=q(x);Ae(u,5,()=>n(f),Se,(h,i,g)=>{var v=pt(),d=q(v);{var M=o=>{var m=ne(),_=ie(m);{var w=A=>{xe(A,{get color(){return n(i),X(()=>n(i).color)}})},y=A=>{var E=ne(),I=ie(E);{var N=T=>{Ce(T,{get color(){return n(i),X(()=>n(i).color)}})},L=T=>{var z=ne(),W=ie(z);{var k=D=>{Te(D,{get color(){return n(i),X(()=>n(i).color)},get rotation(){return n(i),X(()=>n(i).rotation)}})};J(W,D=>{n(i),X(()=>n(i).shape==="arch")&&D(k)},!0)}H(T,z)};J(I,T=>{n(i),X(()=>n(i).shape==="circle")?T(N):T(L,!1)},!0)}H(A,E)};J(_,A=>{n(i),X(()=>n(i).shape==="square")?A(w):A(y,!1)})}H(o,m)};J(d,o=>{n(i)&&o(M)})}C(v),Y("click",v,()=>e()?a(g):S(g)),Y("keydown",v,o=>(e()?a(g):S(g))&&o.key==="Enter"),H(h,v)}),C(u),C(x),K(()=>Q(u,`--width: ${l()??""}; --height: ${c()??""};`)),H(r,x),ue()}var mt=$('<button type="button"></button>'),bt=$('<div class="toolbar svelte-1ld6r3r"><div class="shapes svelte-1ld6r3r" style="display: flex; align-items: center;"><button aria-label="Square" style="width: 2.5rem; height: 2.5rem; padding: 0; display: inline-flex; align-items: center; justify-content: center;"><!></button> <button aria-label="Circle" style="width: 2.5rem; height: 2.5rem; padding: 0; display: inline-flex; align-items: center; justify-content: center;"><!></button> <button aria-label="Arch" style="width: 2.5rem; height: 2.5rem; padding: 0; display: inline-flex; align-items: center; justify-content: center;"><!></button> <button type="button" aria-label="Paint roller tool"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="6" y="4" width="10" height="4" rx="1.5"></rect><path d="M16 6v4c0 1-1 2-2 2H10c-1 0-2-1-2-2V6"></path><rect x="11" y="14" width="2" height="5" rx="1"></rect><path d="M12 12v2"></path></svg></button></div> <div class="colors" style="display: flex; gap: 0.25rem; align-items: center;"></div> <div class="image-upload"><input type="file" accept="image/png, image/jpeg"/></div></div>');function wt(r,t){de(t,!1);let e=V(!1);function a(){B(e,!n(e)),c("paintModeToggled",{paintMode:n(e)})}const s=["#ffffff","#000000","#f4d23e","#e4a9a8","#e3000b","#ff9c08","#008f9b","#0055bf","#a5ca18","#237841","#b4004e","#f785b1","#fbe870","#f5cd2f","#c870a0","#e4e7e7"];function l(k){B(b,k),c("colorSelected",{color:k})}const c=at();let p=V("square"),b=V("#000000");function f(k){B(p,k),c("shapeSelected",{shape:k})}function S(k){const D=k.target,P=D.files&&D.files[0];if(P){const Z=new FileReader;Z.onload=()=>{c("imageUploaded",{src:Z.result})},Z.readAsDataURL(P)}}ve();var x=bt(),u=q(x),h=q(u);let i;var g=q(h);xe(g,{get color(){return n(b)}}),C(h);var v=G(h,2);let d;var M=q(v);Ce(M,{get color(){return n(b)}}),C(v);var o=G(v,2);let m;var _=q(o);Te(_,{get color(){return n(b)},rotation:0}),C(o);var w=G(o,2);let y;var A=q(w),E=q(A),I=G(E),N=G(I),L=G(N);C(A),C(w),C(u);var T=G(u,2);Ae(T,5,()=>s,Se,(k,D)=>{var P=mt();K(()=>{Q(P,`width: 1.5rem; height: 1.5rem; background: ${n(D)??""}; border: 2px solid ${n(b)===n(D)?"#333":"#ccc"}; border-radius: 0.25rem; cursor: pointer;`),F(P,"aria-label",n(D))}),Y("click",P,()=>l(n(D))),H(k,P)}),C(T);var z=G(T,2),W=q(z);C(z),C(x),K((k,D,P,Z)=>{i=ee(h,1,"svelte-1ld6r3r",null,i,k),d=ee(v,1,"svelte-1ld6r3r",null,d,D),m=ee(o,1,"svelte-1ld6r3r",null,m,P),Q(w,`width: 2.5rem; height: 2.5rem; margin-left: 0.5rem; display: inline-flex; align-items: center; justify-content: center; border: 2px solid ${n(e)?"#333":"#ccc"}; background: ${n(e)?"#f4d23e":"#fff"}; border-radius: 0.5rem; cursor: pointer;`),y=ee(w,1,"svelte-1ld6r3r",null,y,Z),F(A,"stroke",n(e)?"#333":"#888"),F(E,"fill",n(e)?"#f4d23e":"#fff"),F(E,"stroke",n(e)?"#333":"#888"),F(I,"stroke",n(e)?"#333":"#888"),F(N,"fill",n(e)?"#f4d23e":"#fff"),F(N,"stroke",n(e)?"#333":"#888"),F(L,"stroke",n(e)?"#333":"#888")},[()=>({selected:n(p)==="square"}),()=>({selected:n(p)==="circle"}),()=>({selected:n(p)==="arch"}),()=>({active:n(e)})]),Y("click",h,()=>f("square")),Y("click",v,()=>f("circle")),Y("click",o,()=>f("arch")),Y("click",w,a),Y("change",W,S),H(r,x),ue()}var yt=$('<main class="svelte-1uha8ag"><!> <!></main>');function Tt(r,t){de(t,!1);let e=V("square"),a=V("#000000"),s=V(null),l=V(!1);function c(d){B(e,d.detail.shape)}function p(d){B(a,d.detail.color)}function b(d){const M=new Image;M.src=d.detail.src,M.onload=()=>{const o=document.createElement("canvas"),m=o.getContext("2d");o.width=32,o.height=32,m.drawImage(M,0,0,32,32);const _=m.getImageData(0,0,32,32).data,w=[];for(let y=0;y<_.length;y+=4){const A=_[y],E=_[y+1],I=_[y+2],N=(A+E+I)/3,L=S(A,E,I),T=x(N);w.push({shape:T,color:L,rotation:0})}B(s,w)}}const f=[{r:0,g:0,b:0},{r:255,g:255,b:255},{r:255,g:0,b:0},{r:0,g:255,b:0},{r:0,g:0,b:255}];function S(d,M,o){let m=f[0],_=1/0;for(const w of f){const y=Math.sqrt(Math.pow(d-w.r,2)+Math.pow(M-w.g,2)+Math.pow(o-w.b,2));y<_&&(_=y,m=w)}return`rgb(${m.r}, ${m.g}, ${m.b})`}function x(d){return d<85?"square":d<170?"arch":"circle"}ve();var u=yt();nt(d=>{rt.title="Dotsly"});var h=q(u);wt(h,{$$events:{shapeSelected:c,colorSelected:p,imageUploaded:b,paintModeToggled:d=>B(l,d.detail.paintMode)}});var i=G(h,2);{var g=d=>{me(d,{width:32,height:32,get selectedShape(){return n(e)},get selectedColor(){return n(a)},get grid(){return n(s)},get paintMode(){return n(l)}})},v=d=>{me(d,{width:32,height:32,get selectedShape(){return n(e)},get selectedColor(){return n(a)},get paintMode(){return n(l)}})};J(i,d=>{n(s)?d(g):d(v,!1)})}C(u),H(r,u),ue()}export{Tt as component};
